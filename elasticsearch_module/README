###### plugin configuration 
https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-engine.html

Config file "elasticsearch/plugin-descriptor.properties" must be set to the used elasticsearch version
	currently 7.12.1
Then, produce a new ZIP archive 'scoresim.zip' *without* including the elasticsearch directory. 

#|____elasticsearch/
#| |____   scoresim.jar <-- classes, resources, dependencies
#| |____   json-simple-1.1.jar
#| |____   plugin-descriptor.properties

###### plugin installation into elasticsearch #####

bin/elasticsearch-plugin install file:///path/to/your/plugin

###### SEARCH QUERIES ####

POST /scorelib/_search
{
	"query": {
	  "function_score": {
	    "query": {
	      "bool": {
	        "must": [
	          {"wildcard": {"opusref": "*palestrina*"}},
	          {"match_phrase": {"diatonic": "5A;3D;2A;"}}
	        ]
	      }
	    },
	    "functions":
	      [{"script_score": {"script": {"lang": "ScoreSim", "source": "ScoreSim",
			    "params": {"query": "(0|1/2)(1|1)(2|1)", "type": 1}}}
	      }]
	  }
	},
	"highlight": {
    "fields" : {
      "diatonic" : {}, "summary": {}
    }
  },
  "fields":[
      "diatonic", "opusref", "summary"
  ],"_source": false
}


#Mapping to aggregate strings like "melody.value"
PUT /scorelib/opus_index/_mapping
{
  "properties": {
    "melody.value": {
      "type": "text",
      "fielddata": true
    }
  }
}

#Amount of scores per corpus
POST scorelib/opus_index/_search
{"aggs" : { "nb_par_corpus" : {
"terms" : {"field" : "corpus_ref"} }}, "size":0}

#Amount of occurrences of a given pattern
POST scorelib/opus_index/_search
{"aggs" : { "nb_par_corpus" : {
"terms" : {"field" : "melody.value"} }}, "size":0}


